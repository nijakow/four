--- /secure/object.c

any create()
{
}

any clone(...)
{
	any instance;
	
	instance = _clone_instance(this);
	instance->create(...);
	return instance;
}


--- /secure/master.c

use log;
use on_connect;

any receive(any connection)
{
	any conn_inst;
	log("New connection!\n");
	conn_inst = "/secure/connection.c"->clone(connection);
}

any create()
{
	on_connect(this, "receive");
}

--- /secure/connection.c

inherit "/secure/object.c";

use _clone_instance;
use log;
use write;
use on_receive;

any conn;

any prompt()
{
	write(conn, "> ");
}

any receive(text)
{
	write(conn, ": ", text);
	prompt();
}

any create(any the_conn)
{
	conn = the_conn;
	x = 0;
	write(conn, "Hey, this is the connection!\n");
	prompt();
	on_receive(the_conn, this, "receive");
}
